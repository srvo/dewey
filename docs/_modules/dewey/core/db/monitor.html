<!DOCTYPE html>

<html lang="en" data-content_root="../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>dewey.core.db.monitor &#8212; Dewey (TUI) 0.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/alabaster.css?v=27fed22d" />
    <script src="../../../../_static/documentation_options.js?v=01f34227"></script>
    <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />

  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />





  </head><body>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">


          <div class="body" role="main">

  <h1>Source code for dewey.core.db.monitor</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Database monitoring module.</span>

<span class="sd">This module provides monitoring and health check functionality for both</span>
<span class="sd">local DuckDB and MotherDuck cloud databases.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_db_config</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.connection</span><span class="w"> </span><span class="kn">import</span> <span class="n">db_manager</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.schema</span><span class="w"> </span><span class="kn">import</span> <span class="n">TABLES</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.sync</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_last_sync_time</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># Global flag to control monitoring thread</span>
<span class="n">_monitoring_active</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">_monitor_thread</span> <span class="o">=</span> <span class="kc">None</span>


<div class="viewcode-block" id="HealthCheckError">
<a class="viewcode-back" href="../../../../dewey.core.db.html#dewey.core.db.monitor.HealthCheckError">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">HealthCheckError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised for health check errors.&quot;&quot;&quot;</span>

    <span class="k">pass</span></div>



<div class="viewcode-block" id="stop_monitoring">
<a class="viewcode-back" href="../../../../dewey.core.db.html#dewey.core.db.monitor.stop_monitoring">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">stop_monitoring</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Stop the monitoring thread.&quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">_monitoring_active</span><span class="p">,</span> <span class="n">_monitor_thread</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Stopping database monitoring&quot;</span><span class="p">)</span>
    <span class="n">_monitoring_active</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">_monitor_thread</span> <span class="ow">and</span> <span class="n">_monitor_thread</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
        <span class="n">_monitor_thread</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Database monitoring stopped&quot;</span><span class="p">)</span></div>



<div class="viewcode-block" id="check_connection">
<a class="viewcode-back" href="../../../../dewey.core.db.html#dewey.core.db.monitor.check_connection">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">check_connection</span><span class="p">(</span><span class="n">local_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check database connection health.</span>

<span class="sd">    Args:</span>
<span class="sd">        local_only: Whether to only check local database</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if connection is healthy, False otherwise</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Try to execute a simple query</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">db_manager</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="s2">&quot;SELECT 1&quot;</span><span class="p">,</span> <span class="n">local_only</span><span class="o">=</span><span class="n">local_only</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">result</span> <span class="ow">and</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Connection check failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span></div>



<div class="viewcode-block" id="check_table_health">
<a class="viewcode-back" href="../../../../dewey.core.db.html#dewey.core.db.monitor.check_table_health">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">check_table_health</span><span class="p">(</span><span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">local_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check health of a specific table.</span>

<span class="sd">    Args:</span>
<span class="sd">        table_name: Name of the table to check</span>
<span class="sd">        local_only: Whether to only check local database</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary containing table health information</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Get table statistics</span>
        <span class="n">stats</span> <span class="o">=</span> <span class="n">db_manager</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            SELECT COUNT(*) as row_count,</span>
<span class="s2">                   SUM(CASE WHEN id IS NULL THEN 1 ELSE 0 END) as null_ids,</span>
<span class="s2">                   MIN(created_at) as oldest_record,</span>
<span class="s2">                   MAX(created_at) as newest_record</span>
<span class="s2">            FROM </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">,</span>
            <span class="n">local_only</span><span class="o">=</span><span class="n">local_only</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">stats</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">HealthCheckError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to get statistics for </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">row_count</span><span class="p">,</span> <span class="n">null_ids</span><span class="p">,</span> <span class="n">oldest</span><span class="p">,</span> <span class="n">newest</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Check for data integrity issues</span>
        <span class="n">issues</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">null_ids</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="n">null_ids</span><span class="si">}</span><span class="s2"> records with NULL IDs&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">row_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Table is empty&quot;</span><span class="p">)</span>

        <span class="c1"># Check for duplicate IDs</span>
        <span class="n">dupes</span> <span class="o">=</span> <span class="n">db_manager</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            SELECT id, COUNT(*) as count</span>
<span class="s2">            FROM </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span>
<span class="s2">            GROUP BY id</span>
<span class="s2">            HAVING COUNT(*) &gt; 1</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">,</span>
            <span class="n">local_only</span><span class="o">=</span><span class="n">local_only</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">dupes</span><span class="p">:</span>
            <span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">dupes</span><span class="p">)</span><span class="si">}</span><span class="s2"> duplicate IDs&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;table_name&quot;</span><span class="p">:</span> <span class="n">table_name</span><span class="p">,</span>
            <span class="s2">&quot;row_count&quot;</span><span class="p">:</span> <span class="n">row_count</span><span class="p">,</span>
            <span class="s2">&quot;null_ids&quot;</span><span class="p">:</span> <span class="n">null_ids</span><span class="p">,</span>
            <span class="s2">&quot;oldest_record&quot;</span><span class="p">:</span> <span class="n">oldest</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span> <span class="k">if</span> <span class="n">oldest</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;newest_record&quot;</span><span class="p">:</span> <span class="n">newest</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span> <span class="k">if</span> <span class="n">newest</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;has_duplicates&quot;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span><span class="n">dupes</span><span class="p">),</span>
            <span class="s2">&quot;duplicate_count&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">dupes</span><span class="p">)</span> <span class="k">if</span> <span class="n">dupes</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;issues&quot;</span><span class="p">:</span> <span class="n">issues</span><span class="p">,</span>
            <span class="s2">&quot;healthy&quot;</span><span class="p">:</span> <span class="ow">not</span> <span class="n">issues</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">error_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Health check failed for </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;table_name&quot;</span><span class="p">:</span> <span class="n">table_name</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="s2">&quot;healthy&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span></div>



<div class="viewcode-block" id="check_sync_health">
<a class="viewcode-back" href="../../../../dewey.core.db.html#dewey.core.db.monitor.check_sync_health">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">check_sync_health</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check health of database synchronization.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary containing sync health information</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">last_sync</span> <span class="o">=</span> <span class="n">get_last_sync_time</span><span class="p">()</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">get_db_config</span><span class="p">()</span>
        <span class="n">sync_interval</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;sync_interval&quot;</span><span class="p">])</span>

        <span class="c1"># Check if sync is overdue</span>
        <span class="n">is_overdue</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">last_sync</span><span class="p">:</span>
            <span class="n">time_since_sync</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">last_sync</span>
            <span class="n">is_overdue</span> <span class="o">=</span> <span class="n">time_since_sync</span> <span class="o">&gt;</span> <span class="n">sync_interval</span>

        <span class="c1"># Check for conflicts</span>
        <span class="n">conflicts</span> <span class="o">=</span> <span class="n">db_manager</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            SELECT COUNT(*) FROM sync_conflicts</span>
<span class="s2">            WHERE resolved = FALSE</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>

        <span class="n">unresolved_conflicts</span> <span class="o">=</span> <span class="n">conflicts</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">conflicts</span> <span class="k">else</span> <span class="mi">0</span>

        <span class="c1"># Check for failed syncs</span>
        <span class="n">failed_syncs</span> <span class="o">=</span> <span class="n">db_manager</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            SELECT COUNT(*) FROM sync_status</span>
<span class="s2">            WHERE status = &#39;error&#39;</span>
<span class="s2">            AND sync_time &gt; CURRENT_TIMESTAMP - INTERVAL &#39;24 HOURS&#39;</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>

        <span class="n">recent_failures</span> <span class="o">=</span> <span class="n">failed_syncs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">failed_syncs</span> <span class="k">else</span> <span class="mi">0</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;last_sync&quot;</span><span class="p">:</span> <span class="n">last_sync</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span> <span class="k">if</span> <span class="n">last_sync</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;sync_interval&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">sync_interval</span><span class="p">),</span>
            <span class="s2">&quot;is_overdue&quot;</span><span class="p">:</span> <span class="n">is_overdue</span><span class="p">,</span>
            <span class="s2">&quot;unresolved_conflicts&quot;</span><span class="p">:</span> <span class="n">unresolved_conflicts</span><span class="p">,</span>
            <span class="s2">&quot;recent_failures&quot;</span><span class="p">:</span> <span class="n">recent_failures</span><span class="p">,</span>
            <span class="s2">&quot;healthy&quot;</span><span class="p">:</span> <span class="ow">not</span> <span class="p">(</span><span class="n">is_overdue</span> <span class="ow">or</span> <span class="n">unresolved_conflicts</span> <span class="ow">or</span> <span class="n">recent_failures</span><span class="p">),</span>
        <span class="p">}</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">error_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Sync health check failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="s2">&quot;healthy&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span></div>



<div class="viewcode-block" id="check_schema_consistency">
<a class="viewcode-back" href="../../../../dewey.core.db.html#dewey.core.db.monitor.check_schema_consistency">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">check_schema_consistency</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check schema consistency between local and MotherDuck databases.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary containing schema consistency information</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">inconsistencies</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">table_name</span> <span class="ow">in</span> <span class="n">TABLES</span><span class="p">:</span>
            <span class="c1"># Get schema from both databases</span>
            <span class="n">local_schema</span> <span class="o">=</span> <span class="n">db_manager</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;DESCRIBE </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">local_only</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
            <span class="n">remote_schema</span> <span class="o">=</span> <span class="n">db_manager</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;DESCRIBE </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">local_only</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>

            <span class="c1"># Compare schemas</span>
            <span class="k">if</span> <span class="n">local_schema</span> <span class="o">!=</span> <span class="n">remote_schema</span><span class="p">:</span>
                <span class="c1"># Find specific differences</span>
                <span class="n">local_cols</span> <span class="o">=</span> <span class="p">{</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">row</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">local_schema</span><span class="p">}</span>
                <span class="n">remote_cols</span> <span class="o">=</span> <span class="p">{</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">row</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">remote_schema</span><span class="p">}</span>

                <span class="c1"># Check for missing columns</span>
                <span class="n">local_missing</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">remote_cols</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">local_cols</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                <span class="n">remote_missing</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">local_cols</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">remote_cols</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

                <span class="c1"># Check for type mismatches</span>
                <span class="n">type_mismatches</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">local_cols</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">remote_cols</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="k">if</span> <span class="n">local_cols</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">!=</span> <span class="n">remote_cols</span><span class="p">[</span><span class="n">col</span><span class="p">]:</span>
                        <span class="n">type_mismatches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                            <span class="p">{</span>
                                <span class="s2">&quot;column&quot;</span><span class="p">:</span> <span class="n">col</span><span class="p">,</span>
                                <span class="s2">&quot;local_type&quot;</span><span class="p">:</span> <span class="n">local_cols</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                                <span class="s2">&quot;remote_type&quot;</span><span class="p">:</span> <span class="n">remote_cols</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                            <span class="p">}</span>
                        <span class="p">)</span>

                <span class="n">inconsistencies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="n">table_name</span><span class="p">,</span>
                        <span class="s2">&quot;local_missing&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">local_missing</span><span class="p">),</span>
                        <span class="s2">&quot;remote_missing&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">remote_missing</span><span class="p">),</span>
                        <span class="s2">&quot;type_mismatches&quot;</span><span class="p">:</span> <span class="n">type_mismatches</span><span class="p">,</span>
                    <span class="p">}</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;consistent&quot;</span><span class="p">:</span> <span class="ow">not</span> <span class="n">inconsistencies</span><span class="p">,</span> <span class="s2">&quot;inconsistencies&quot;</span><span class="p">:</span> <span class="n">inconsistencies</span><span class="p">}</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">error_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Schema consistency check failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="s2">&quot;consistent&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span></div>



<div class="viewcode-block" id="check_database_size">
<a class="viewcode-back" href="../../../../dewey.core.db.html#dewey.core.db.monitor.check_database_size">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">check_database_size</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check database size and growth.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary containing database size information</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Get table sizes</span>
        <span class="n">sizes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">total_rows</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">table_name</span> <span class="ow">in</span> <span class="n">TABLES</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">db_manager</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                SELECT COUNT(*) as row_count,</span>
<span class="s2">                       SUM(LENGTH(CAST(* AS VARCHAR))) as approx_size</span>
<span class="s2">                FROM </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">result</span> <span class="ow">and</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">row_count</span><span class="p">,</span> <span class="n">approx_size</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">total_rows</span> <span class="o">+=</span> <span class="n">row_count</span>
                <span class="n">sizes</span><span class="p">[</span><span class="n">table_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;row_count&quot;</span><span class="p">:</span> <span class="n">row_count</span><span class="p">,</span>
                    <span class="s2">&quot;approx_size_bytes&quot;</span><span class="p">:</span> <span class="n">approx_size</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">,</span>
                <span class="p">}</span>

        <span class="c1"># Get database file size</span>
        <span class="n">db_size</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">get_db_config</span><span class="p">()[</span><span class="s2">&quot;local_db_path&quot;</span><span class="p">])</span>

        <span class="c1"># Calculate size metrics</span>
        <span class="n">total_data_size</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="s2">&quot;approx_size_bytes&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">sizes</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">avg_row_size</span> <span class="o">=</span> <span class="n">total_data_size</span> <span class="o">/</span> <span class="n">total_rows</span> <span class="k">if</span> <span class="n">total_rows</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;file_size_bytes&quot;</span><span class="p">:</span> <span class="n">db_size</span><span class="p">,</span>
            <span class="s2">&quot;total_rows&quot;</span><span class="p">:</span> <span class="n">total_rows</span><span class="p">,</span>
            <span class="s2">&quot;total_data_size_bytes&quot;</span><span class="p">:</span> <span class="n">total_data_size</span><span class="p">,</span>
            <span class="s2">&quot;average_row_size_bytes&quot;</span><span class="p">:</span> <span class="n">avg_row_size</span><span class="p">,</span>
            <span class="s2">&quot;table_sizes&quot;</span><span class="p">:</span> <span class="n">sizes</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">error_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Size check failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span></div>



<div class="viewcode-block" id="check_query_performance">
<a class="viewcode-back" href="../../../../dewey.core.db.html#dewey.core.db.monitor.check_query_performance">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">check_query_performance</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check database query performance.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary containing performance metrics</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">metrics</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Test simple query performance</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">db_manager</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="s2">&quot;SELECT 1&quot;</span><span class="p">)</span>
        <span class="n">simple_query_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

        <span class="c1"># Test table scan performance</span>
        <span class="n">table_metrics</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">table_name</span> <span class="ow">in</span> <span class="n">TABLES</span><span class="p">:</span>
            <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">db_manager</span><span class="o">.</span><span class="n">execute_query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                SELECT COUNT(*) FROM </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>
            <span class="n">scan_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

            <span class="n">row_count</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">result</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">rows_per_sec</span> <span class="o">=</span> <span class="n">row_count</span> <span class="o">/</span> <span class="n">scan_time</span> <span class="k">if</span> <span class="n">scan_time</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>

            <span class="n">table_metrics</span><span class="p">[</span><span class="n">table_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;scan_time_seconds&quot;</span><span class="p">:</span> <span class="n">scan_time</span><span class="p">,</span>
                <span class="s2">&quot;row_count&quot;</span><span class="p">:</span> <span class="n">row_count</span><span class="p">,</span>
                <span class="s2">&quot;rows_per_second&quot;</span><span class="p">:</span> <span class="n">rows_per_sec</span><span class="p">,</span>
            <span class="p">}</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;simple_query_time_seconds&quot;</span><span class="p">:</span> <span class="n">simple_query_time</span><span class="p">,</span>
            <span class="s2">&quot;table_metrics&quot;</span><span class="p">:</span> <span class="n">table_metrics</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">error_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Performance check failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span></div>



<div class="viewcode-block" id="run_health_check">
<a class="viewcode-back" href="../../../../dewey.core.db.html#dewey.core.db.monitor.run_health_check">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">run_health_check</span><span class="p">(</span><span class="n">include_performance</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run a comprehensive health check on the database.</span>

<span class="sd">    Args:</span>
<span class="sd">        include_performance: Whether to include performance metrics</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary containing all health check results</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
        <span class="s2">&quot;connection&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;local&quot;</span><span class="p">:</span> <span class="n">check_connection</span><span class="p">(</span><span class="n">local_only</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
            <span class="s2">&quot;motherduck&quot;</span><span class="p">:</span> <span class="n">check_connection</span><span class="p">(</span><span class="n">local_only</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
        <span class="p">},</span>
        <span class="s2">&quot;tables&quot;</span><span class="p">:</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">check_table_health</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">TABLES</span><span class="p">},</span>
        <span class="s2">&quot;sync&quot;</span><span class="p">:</span> <span class="n">check_sync_health</span><span class="p">(),</span>
        <span class="s2">&quot;schema&quot;</span><span class="p">:</span> <span class="n">check_schema_consistency</span><span class="p">(),</span>
        <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="n">check_database_size</span><span class="p">(),</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">include_performance</span><span class="p">:</span>
        <span class="n">results</span><span class="p">[</span><span class="s2">&quot;performance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">check_query_performance</span><span class="p">()</span>

    <span class="c1"># Calculate overall health</span>
    <span class="n">is_healthy</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">results</span><span class="p">[</span><span class="s2">&quot;connection&quot;</span><span class="p">][</span><span class="s2">&quot;local&quot;</span><span class="p">]</span>
        <span class="ow">and</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;connection&quot;</span><span class="p">][</span><span class="s2">&quot;motherduck&quot;</span><span class="p">]</span>
        <span class="ow">and</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;sync&quot;</span><span class="p">][</span><span class="s2">&quot;healthy&quot;</span><span class="p">]</span>
        <span class="ow">and</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;schema&quot;</span><span class="p">][</span><span class="s2">&quot;consistent&quot;</span><span class="p">]</span>
        <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="s2">&quot;healthy&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;tables&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="p">)</span>

    <span class="n">results</span><span class="p">[</span><span class="s2">&quot;healthy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">is_healthy</span>

    <span class="k">return</span> <span class="n">results</span></div>



<div class="viewcode-block" id="monitor_database">
<a class="viewcode-back" href="../../../../dewey.core.db.html#dewey.core.db.monitor.monitor_database">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">monitor_database</span><span class="p">(</span><span class="n">interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span> <span class="n">run_once</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run regular database monitoring.</span>

<span class="sd">    Args:</span>
<span class="sd">        interval: Monitoring interval in seconds</span>
<span class="sd">        run_once: Whether to run only once instead of in a loop</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">_monitoring_active</span><span class="p">,</span> <span class="n">_monitor_thread</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Set the monitoring flag</span>
        <span class="n">_monitoring_active</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># Set current thread as monitor thread</span>
        <span class="n">_monitor_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">current_thread</span><span class="p">()</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting database monitoring (interval: </span><span class="si">{</span><span class="n">interval</span><span class="si">}</span><span class="s2">s)&quot;</span><span class="p">)</span>

        <span class="k">while</span> <span class="n">_monitoring_active</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Run health check</span>
                <span class="n">health</span> <span class="o">=</span> <span class="n">run_health_check</span><span class="p">()</span>

                <span class="c1"># Handle issues</span>
                <span class="k">if</span> <span class="n">health</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;healthy&quot;</span><span class="p">:</span>
                    <span class="n">issues</span> <span class="o">=</span> <span class="n">health</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;issues&quot;</span><span class="p">,</span> <span class="p">[])</span>
                    <span class="k">for</span> <span class="n">issue</span> <span class="ow">in</span> <span class="n">issues</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">issue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;severity&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;critical&quot;</span><span class="p">:</span>
                            <span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span>
                                <span class="sa">f</span><span class="s2">&quot;Critical database issue: </span><span class="si">{</span><span class="n">issue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                            <span class="p">)</span>
                        <span class="k">elif</span> <span class="n">issue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;severity&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;warning&quot;</span><span class="p">:</span>
                            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Database warning: </span><span class="si">{</span><span class="n">issue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error during monitoring: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># For single run, exit loop</span>
            <span class="k">if</span> <span class="n">run_once</span><span class="p">:</span>
                <span class="k">break</span>

            <span class="c1"># Wait for next interval if not stopping</span>
            <span class="k">if</span> <span class="n">_monitoring_active</span><span class="p">:</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Database monitoring failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">_monitoring_active</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Database monitoring exited&quot;</span><span class="p">)</span></div>

</pre></div>

          </div>

        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../../index.html">Dewey (TUI)</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../index.html">Documentation overview</a><ul>
  <li><a href="../../../index.html">Module code</a><ul>
  <li><a href="../../../dewey.html">dewey</a><ul>
  <li><a href="../db.html">dewey.core.db</a><ul>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Sloane Ortel.

      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>

    </div>




  </body>
</html>
